---
sidebar_position: 6
title: "集合工具类"
description: "Java集合工具类详解"
authors: [Laby]
last_update:
  date: 2025-08-07
  author: Laby
---

# 集合工具类

Java提供了丰富的集合工具类，主要包括`Collections`和`Arrays`工具类，以及Apache Commons Collections等第三方库。这些工具类提供了大量便捷的方法来操作集合。

## Collections工具类

### 1. 排序操作

```java
import java.util.*;

// 自然排序
List`<String>` names = Arrays.asList("Alice", "Bob", "Charlie");
Collections.sort(names);
System.out.println(names); // [Alice, Bob, Charlie]

// 自定义排序
List`<Person>` people = Arrays.asList(
    new Person("Alice", 25),
    new Person("Bob", 30),
    new Person("Charlie", 20)
);
Collections.sort(people, Comparator.comparing(Person::getAge));
System.out.println(people); // 按年龄排序

// 逆序排序
Collections.sort(names, Collections.reverseOrder());
System.out.println(names); // [Charlie, Bob, Alice]
```

### 2. 查找和替换

```java
// 二分查找（要求列表已排序）
List`<Integer>` numbers = Arrays.asList(1, 3, 5, 7, 9);
int index = Collections.binarySearch(numbers, 5);
System.out.println("5的索引: " + index); // 2

// 查找最大最小值
Integer max = Collections.max(numbers);
Integer min = Collections.min(numbers);
System.out.println("最大值: " + max + ", 最小值: " + min);

// 替换所有元素
List`<String>` list = new ArrayList`<>`(Arrays.asList("a", "b", "a", "c"));
Collections.replaceAll(list, "a", "x");
System.out.println(list); // [x, b, x, c]

// 填充集合
List`<String>` fillList = new ArrayList`<>`(Arrays.asList("a", "b", "c"));
Collections.fill(fillList, "default");
System.out.println(fillList); // [default, default, default]
```

### 3. 同步和不可变集合

```java
// 创建同步集合
List`<String>` syncList = Collections.synchronizedList(new ArrayList`<>`());
Set`<String>` syncSet = Collections.synchronizedSet(new HashSet`<>`());
Map`<String, String>` syncMap = Collections.synchronizedMap(new HashMap`<>`());

// 创建不可变集合
List`<String>` immutableList = Collections.unmodifiableList(Arrays.asList("a", "b", "c"));
Set`<String>` immutableSet = Collections.unmodifiableSet(new HashSet`<>`(Arrays.asList("a", "b", "c")));
Map`<String, String>` immutableMap = Collections.unmodifiableMap(new HashMap`<>`());

// 尝试修改不可变集合会抛出异常
try {
    immutableList.add("d"); // 抛出UnsupportedOperationException
} catch (UnsupportedOperationException e) {
    System.out.println("不能修改不可变集合");
}
```

### 4. 集合操作

```java
// 交换元素
List`<String>` swapList = new ArrayList`<>`(Arrays.asList("a", "b", "c"));
Collections.swap(swapList, 0, 2);
System.out.println(swapList); // [c, b, a]

// 旋转集合
List`<String>` rotateList = new ArrayList`<>`(Arrays.asList("a", "b", "c", "d"));
Collections.rotate(rotateList, 2);
System.out.println(rotateList); // [c, d, a, b]

// 随机打乱
List`<String>` shuffleList = new ArrayList`<>`(Arrays.asList("a", "b", "c", "d"));
Collections.shuffle(shuffleList);
System.out.println(shuffleList); // 随机顺序

// 反转集合
List`<String>` reverseList = new ArrayList`<>`(Arrays.asList("a", "b", "c"));
Collections.reverse(reverseList);
System.out.println(reverseList); // [c, b, a]
```

### 5. 频率统计

```java
// 统计元素出现次数
List`<String>` freqList = Arrays.asList("a", "b", "a", "c", "a", "b");
int aCount = Collections.frequency(freqList, "a");
System.out.println("a出现次数: " + aCount); // 3

// 检查两个集合是否有共同元素
List`<String>` list1 = Arrays.asList("a", "b", "c");
List`<String>` list2 = Arrays.asList("b", "c", "d");
boolean hasCommon = !Collections.disjoint(list1, list2);
System.out.println("有共同元素: " + hasCommon); // true
```

## Arrays工具类

### 1. 数组排序和查找

```java
// 数组排序
int[] numbers = {3, 1, 4, 1, 5, 9, 2, 6};
Arrays.sort(numbers);
System.out.println(Arrays.toString(numbers)); // [1, 1, 2, 3, 4, 5, 6, 9]

// 部分排序
int[] partialSort = {3, 1, 4, 1, 5, 9, 2, 6};
Arrays.sort(partialSort, 2, 6); // 只排序索引2到5的元素
System.out.println(Arrays.toString(partialSort)); // [3, 1, 1, 4, 5, 9, 2, 6]

// 二分查找
int index = Arrays.binarySearch(numbers, 5);
System.out.println("5的索引: " + index); // 5

// 并行排序（大数据量）
int[] largeArray = new int[1000000];
// 填充数据...
Arrays.parallelSort(largeArray);
```

### 2. 数组比较和填充

```java
// 数组比较
int[] arr1 = {1, 2, 3};
int[] arr2 = {1, 2, 3};
int[] arr3 = {1, 2, 4};

System.out.println(Arrays.equals(arr1, arr2)); // true
System.out.println(Arrays.equals(arr1, arr3)); // false

// 深度比较（用于多维数组）
int[][] matrix1 = {{1, 2}, {3, 4}};
int[][] matrix2 = {{1, 2}, {3, 4}};
System.out.println(Arrays.deepEquals(matrix1, matrix2)); // true

// 数组填充
int[] fillArray = new int[5];
Arrays.fill(fillArray, 42);
System.out.println(Arrays.toString(fillArray)); // [42, 42, 42, 42, 42]

// 部分填充
int[] partialFill = {1, 2, 3, 4, 5};
Arrays.fill(partialFill, 1, 3, 0); // 填充索引1到2
System.out.println(Arrays.toString(partialFill)); // [1, 0, 0, 4, 5]
```

### 3. 数组转换

```java
// 数组转List
String[] stringArray = {"a", "b", "c"};
List`<String>` stringList = Arrays.asList(stringArray);
System.out.println(stringList); // [a, b, c]

// 注意：Arrays.asList返回的List是固定大小的
try {
    stringList.add("d"); // 抛出UnsupportedOperationException
} catch (UnsupportedOperationException e) {
    System.out.println("不能修改固定大小的List");
}

// 创建可修改的List
List`<String>` modifiableList = new ArrayList`<>`(Arrays.asList(stringArray));
modifiableList.add("d"); // 可以修改

// 数组转Stream
int[] intArray = {1, 2, 3, 4, 5};
IntStream intStream = Arrays.stream(intArray);
intStream.forEach(System.out::println);
```

## 实用工具方法

### 1. 集合判空和null检查

```java
public class CollectionUtils {
    
    // 检查集合是否为空
    public static boolean isEmpty(Collection`<?>` collection) {
        return collection == null || collection.isEmpty();
    }
    
    // 检查集合是否不为空
    public static boolean isNotEmpty(Collection`<?>` collection) {
        return !isEmpty(collection);
    }
    
    // 安全获取集合大小
    public static int size(Collection`<?>` collection) {
        return collection == null ? 0 : collection.size();
    }
    
    // 创建空集合
    public static <T> List`<T>` emptyList() {
        return Collections.emptyList();
    }
    
    public static <T> Set`<T>` emptySet() {
        return Collections.emptySet();
    }
}
```

### 2. 集合转换工具

```java
public class CollectionConverter {
    
    // List转Set
    public static <T> Set`<T>` listToSet(List`<T>` list) {
        return new HashSet`<>`(list);
    }
    
    // Set转List
    public static <T> List`<T>` setToList(Set`<T>` set) {
        return new ArrayList`<>`(set);
    }
    
    // 数组转List
    public static <T> List`<T>` arrayToList(T[] array) {
        return Arrays.asList(array);
    }
    
    // List转数组
    public static <T> T[] listToArray(List`<T>` list, Class`<T>` clazz) {
        @SuppressWarnings("unchecked")
        T[] array = (T[]) Array.newInstance(clazz, list.size());
        return list.toArray(array);
    }
}
```

### 3. 集合操作工具

```java
public class CollectionOperations {
    
    // 交集
    public static <T> Set`<T>` intersection(Collection`<T>` c1, Collection`<T>` c2) {
        Set`<T>` result = new HashSet`<>`(c1);
        result.retainAll(c2);
        return result;
    }
    
    // 并集
    public static <T> Set`<T>` union(Collection`<T>` c1, Collection`<T>` c2) {
        Set`<T>` result = new HashSet`<>`(c1);
        result.addAll(c2);
        return result;
    }
    
    // 差集
    public static <T> Set`<T>` difference(Collection`<T>` c1, Collection`<T>` c2) {
        Set`<T>` result = new HashSet`<>`(c1);
        result.removeAll(c2);
        return result;
    }
    
    // 分割集合
    public static <T> List`<List<T>>` partition(List`<T>` list, int size) {
        List`<List<T>>` partitions = new ArrayList`<>`();
        for (int i = 0; i < list.size(); i += size) {
            int end = Math.min(i + size, list.size());
            partitions.add(list.subList(i, end));
        }
        return partitions;
    }
}
```

## 性能优化建议

### 1. 选择合适的集合类型

```java
// 频繁查找 - 使用HashSet
Set`<String>` lookupSet = new HashSet`<>`();

// 需要排序 - 使用TreeSet
Set`<String>` sortedSet = new TreeSet`<>`();

// 频繁插入删除 - 使用LinkedList
List`<String>` frequentModify = new LinkedList`<>`();

// 随机访问 - 使用ArrayList
List`<String>` randomAccess = new ArrayList`<>`();
```

### 2. 预分配容量

```java
// 预分配容量避免扩容
List`<String>` list = new ArrayList`<>`(1000);
Set`<String>` set = new HashSet`<>`(1000);
Map`<String, String>` map = new HashMap`<>`(1000);
```

### 3. 使用并行流处理大数据量

```java
// 并行处理大数据量
List`<String>` largeList = getLargeList(); // 大数据集
List`<String>` processed = largeList.parallelStream()
    .filter(s -> s.length() > 5)
    .map(String::toUpperCase)
    .collect(Collectors.toList());
```

## 面试题 

### 1. Collections.sort()和Arrays.sort()有什么区别？

**答案：**
- Collections.sort()用于List集合，内部调用Arrays.sort()
- Arrays.sort()用于数组，支持基本类型和对象数组
- 两者都使用TimSort算法，时间复杂度O(n log n)

### 2. 如何创建线程安全的集合？

**答案：**
- 使用Collections.synchronizedXXX()方法
- 使用ConcurrentHashMap、CopyOnWriteArrayList等并发集合
- 使用Collections.synchronizedMap()等包装方法

### 3. Arrays.asList()返回的List有什么特点？

**答案：**
- 返回固定大小的List，不能添加或删除元素
- 对原数组的修改会反映到List中
- 如果需要可修改的List，使用new ArrayList`<>`(Arrays.asList())

### 4. 如何高效地合并两个集合？

**答案：**
- 使用addAll()方法
- 预分配容量避免扩容
- 对于Set，直接使用addAll()即可去重
- 对于List，可以使用Stream API的concat

### 5. Collections.emptyList()和new ArrayList`<>`()有什么区别？

**答案：**
- emptyList()返回不可变的空List，节省内存
- new ArrayList`<>`()创建可变的空List
- emptyList()适合作为默认返回值，避免null检查 